import{B as z,r as h,j as e,a as E,u as I,R as j}from"./index-DwcND9pF.js";import{n as R,o as _,l as C,p as D}from"./index-CCbgk3eJ.js";import{d as F,g as N}from"./post-methods-DtH6erlw.js";var b={exports:{}},v,T;function O(){if(T)return v;T=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return v=s,v}var y,S;function q(){if(S)return y;S=1;var s=O();function c(){}function d(){}return d.resetWarningCache=c,y=function(){function t(m,p,u,x,a,l){if(l!==s){var r=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw r.name="Invariant Violation",r}}t.isRequired=t;function n(){return t}var o={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:n,element:t,elementType:t,instanceOf:n,node:t,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:d,resetWarningCache:c};return o.PropTypes=o,o},y}var P;function W(){return P||(P=1,b.exports=q()()),b.exports}var A=W();const i=z(A),k=({images:s,content:c})=>{const[d,t]=h.useState(!1),[n,o]=h.useState(0),[m,p]=h.useState({}),u=a=>{p(l=>({...l,[a]:!0}))},x=s.map((a,l)=>({url:a,originalIndex:l})).filter(a=>!m[a.originalIndex]);return x.length===0?null:e.jsxs("div",{className:"relative w-full rounded-lg overflow-hidden group/image",children:[e.jsx("div",{className:"flex flex-row overflow-x-auto snap-x snap-mandatory scrollbar-hide w-full scroll-smooth",onClick:()=>t(!d),onScroll:a=>{const l=a.currentTarget.offsetWidth,r=a.currentTarget.scrollLeft,f=Math.round(r/l);o(f)},children:x.map((a,l)=>e.jsxs("div",{className:"w-full flex-shrink-0 snap-center relative h-[500px] flex items-center justify-center bg-slate-100 overflow-hidden",children:[e.jsx("img",{src:a.url,alt:"",className:"absolute inset-0 w-full h-full object-cover blur-2xl opacity-50 scale-110",onError:()=>u(a.originalIndex)}),e.jsx("img",{src:a.url,alt:`slide-${l}`,className:"relative w-full h-full object-contain z-10 drop-shadow-md transition-transform duration-300",loading:"lazy",onError:()=>u(a.originalIndex)})]},a.originalIndex))}),d&&e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-slate-900/80 backdrop-blur-sm p-4 text-white/90 font-['Ubuntu'] text-sm leading-relaxed max-h-[60%] overflow-y-auto animate-in slide-in-from-bottom-5 duration-200 z-10",onClick:()=>t(!1),children:[e.jsx("div",{className:"mx-auto w-12 h-1 bg-white/20 rounded-full mb-3"}),c]}),x.length>1&&e.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-1.5 z-10 pointer-events-none",children:x.map((a,l)=>e.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-all duration-300 shadow-sm ${l===n?"bg-white w-2.5 scale-110":"bg-white/50"}`},l))}),!d&&c&&e.jsx("div",{className:"absolute bottom-3 right-3 bg-black/30 text-white p-1.5 rounded-full backdrop-blur-sm pointer-events-none opacity-50 group-hover/image:opacity-100 transition-opacity",children:e.jsx(R,{size:12,className:"rotate-180"})})]})};k.propTypes={images:i.arrayOf(i.string).isRequired,content:i.string};const w=({post:s,onDelete:c})=>{const[d,t]=h.useState(!1),n=E(),{user:o}=I(),m=async()=>{window.confirm("Bu gönderiyi silmek istediğinize emin misiniz?")&&(await F(s.id)===null?c&&c(s.id):alert("Silme işlemi başarısız oldu."))},p=s.images&&Array.isArray(s.images)?s.images:s.image_url?[s.image_url]:[],u=p.length>0;return e.jsxs("div",{className:"bg-white border border-slate-100 rounded-xl shadow-sm hover:shadow-md transition-shadow duration-300 overflow-hidden group",children:[e.jsxs("div",{className:"px-4 py-3 flex justify-between items-start bg-slate-100/50 border-b border-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 overflow-hidden ring-2 ring-slate-50",children:e.jsx("img",{src:"https://pbs.twimg.com/profile_images/1483105275766882304/4CYpr2hO_400x400.jpg",alt:"Profile",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"text-slate-800 font-bold text-sm font-['Ubuntu']",children:"Serhat Öcal"}),e.jsx("span",{className:"text-slate-400 text-xs font-['Ubuntu']",children:s.timestamp?.seconds?new Date(s.timestamp.seconds*1e3).toLocaleDateString("tr-TR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}):"Tarih yok"})]})]}),o&&o.uid==="2t2Fg2aX8ePpfhsDAWoYEosDcmv1"&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>t(!d),className:"p-2 text-slate-300 hover:text-slate-500 transition-colors",children:e.jsx(_,{size:20})}),d&&e.jsxs("div",{className:"absolute right-0 top-8 bg-white border border-slate-100 shadow-lg rounded-lg py-1 w-32 z-20 animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("button",{onClick:()=>n("/create-post",{state:{postToEdit:s}}),className:"w-full text-left px-4 py-2 text-sm text-slate-600 hover:bg-slate-50 flex items-center gap-2",children:[e.jsx(R,{size:14})," Düzenle"]}),e.jsxs("button",{onClick:m,className:"w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(C,{size:14})," Sil"]})]}),d&&e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>t(!1)})]})]}),e.jsx("div",{className:"p-4 bg-slate-50/30 min-h-[5rem]",children:u?e.jsx(k,{images:p,content:s.content}):e.jsx("p",{className:"text-slate-700 font-['Ubuntu'] text-lg leading-relaxed whitespace-pre-wrap",children:s.content})}),e.jsx("div",{className:"bg-slate-100/50 px-4 py-3 flex items-center gap-4 border-t border-slate-100 min-h-[3.5rem]",children:e.jsx("button",{className:"flex items-center gap-2 text-slate-400 hover:text-blue-500 transition-colors group",title:"Bağlantı (Yakında)",children:e.jsx(D,{size:20,className:"group-hover:scale-110 transition-transform"})})})]})};w.propTypes={post:i.shape({id:i.string.isRequired,content:i.string.isRequired,image_url:i.string,images:i.arrayOf(i.string),timestamp:i.shape({seconds:i.number,nanoseconds:i.number,toDate:i.func})}).isRequired,onDelete:i.func};function V(){const[s,c]=h.useState([]),[d,t]=h.useState(null),[n,o]=h.useState(!1),[m,p]=h.useState(!0),u=j.useRef(),x=j.useCallback(r=>{n||(u.current&&u.current.disconnect(),u.current=new IntersectionObserver(f=>{f[0].isIntersecting&&m&&(t(g=>g),a())}),r&&u.current.observe(r))},[n,m]),a=async()=>{if(n||!m)return;o(!0);const r=await N(d);r.posts.length>0?(c(f=>[...f,...r.posts]),t(r.lastVisible),r.posts.length<10&&p(!1)):p(!1),o(!1)},l=r=>{c(f=>f.filter(g=>g.id!==r))};return h.useEffect(()=>{(async()=>{o(!0);const r=await N(null);c(r.posts),t(r.lastVisible),r.posts.length<10&&p(!1),o(!1)})()},[]),e.jsxs("div",{className:"relative flex flex-col w-full h-[100dvh] overflow-hidden bg-slate-50",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[60vw] h-[60vw] bg-slate-300 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob pointer-events-none"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[60vw] h-[60vw] bg-gray-300 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob animation-delay-2000 pointer-events-none"}),e.jsxs("div",{className:"flex-1 overflow-y-auto z-10 w-full max-w-2xl mx-auto px-4 py-6 custom-scrollbar space-y-4",children:[s.map((r,f)=>s.length===f+1?e.jsx("div",{ref:x,children:e.jsx(w,{post:r,onDelete:l})},r.id):e.jsx(w,{post:r,onDelete:l},r.id)),n&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-8 h-8 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin"})}),!m&&s.length>0&&e.jsx("p",{className:"text-center text-slate-400 py-4 text-xs",children:"Tüm gönderiler yüklendi."}),!n&&s.length===0&&e.jsx("div",{className:"flex flex-col items-center justify-center h-full text-slate-400 font-['Ubuntu']",children:e.jsx("p",{children:"Henüz gönderi yok."})})]})]})}export{V as default};

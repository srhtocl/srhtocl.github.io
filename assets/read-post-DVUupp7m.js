import{B as _,r as m,a as C,u as D,j as e,R as j}from"./index-Dn8E-IOM.js";import{m as E,n as N,j as F,o as O}from"./index-zbd9w0jO.js";import{d as q,g as T}from"./post-methods-vhNzHift.js";var b={exports:{}},v,S;function W(){if(S)return v;S=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return v=s,v}var y,P;function I(){if(P)return y;P=1;var s=W();function c(){}function u(){}return u.resetWarningCache=c,y=function(){function a(p,f,h,x,g,d){if(d!==s){var t=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw t.name="Invariant Violation",t}}a.isRequired=a;function r(){return a}var i={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:r,element:a,elementType:a,instanceOf:r,node:a,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:u,resetWarningCache:c};return i.PropTypes=i,i},y}var R;function A(){return R||(R=1,b.exports=I()()),b.exports}var L=A();const o=_(L),w=({post:s,onDelete:c})=>{const[u,a]=m.useState(!1),[r,i]=m.useState(!1),[p,f]=m.useState(0),h=C(),{user:x}=D(),g=async()=>{window.confirm("Bu gönderiyi silmek istediğinize emin misiniz?")&&(await q(s.id)===null?c&&c(s.id):alert("Silme işlemi başarısız oldu."))},d=s.images&&Array.isArray(s.images)?s.images:s.image_url?[s.image_url]:[],t=d.length>0;return e.jsxs("div",{className:"bg-white border border-slate-100 rounded-xl shadow-sm hover:shadow-md transition-shadow duration-300 overflow-hidden group",children:[e.jsxs("div",{className:"px-4 py-3 flex justify-between items-start bg-slate-100/50 border-b border-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 overflow-hidden ring-2 ring-slate-50",children:e.jsx("img",{src:"https://pbs.twimg.com/profile_images/1483105275766882304/4CYpr2hO_400x400.jpg",alt:"Profile",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"text-slate-800 font-bold text-sm font-['Ubuntu']",children:"Serhat Öcal"}),e.jsx("span",{className:"text-slate-400 text-xs font-['Ubuntu']",children:s.timestamp?.seconds?new Date(s.timestamp.seconds*1e3).toLocaleDateString("tr-TR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}):"Tarih yok"})]})]}),x&&x.uid==="2t2Fg2aX8ePpfhsDAWoYEosDcmv1"&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!u),className:"p-2 text-slate-300 hover:text-slate-500 transition-colors",children:e.jsx(E,{size:20})}),u&&e.jsxs("div",{className:"absolute right-0 top-8 bg-white border border-slate-100 shadow-lg rounded-lg py-1 w-32 z-20 animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("button",{onClick:()=>h("/create-post",{state:{postToEdit:s}}),className:"w-full text-left px-4 py-2 text-sm text-slate-600 hover:bg-slate-50 flex items-center gap-2",children:[e.jsx(N,{size:14})," Düzenle"]}),e.jsxs("button",{onClick:g,className:"w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(F,{size:14})," Sil"]})]}),u&&e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>a(!1)})]})]}),e.jsx("div",{className:"p-4 bg-slate-50/30 min-h-[5rem]",children:t?e.jsxs("div",{className:"relative w-full rounded-lg overflow-hidden group/image",children:[e.jsx("div",{className:"flex flex-row overflow-x-auto snap-x snap-mandatory scrollbar-hide w-full scroll-smooth",onClick:()=>i(!r),onScroll:n=>{const l=n.currentTarget.offsetWidth,k=n.currentTarget.scrollLeft,z=Math.round(k/l);f(z)},children:d.map((n,l)=>e.jsx("div",{className:"w-full flex-shrink-0 snap-center relative",children:e.jsx("img",{src:n,alt:`Gönderi görseli ${l+1}`,className:"w-full h-auto object-cover max-h-[500px]",loading:"lazy"})},l))}),r&&e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-slate-900/80 backdrop-blur-sm p-4 text-white/90 font-['Ubuntu'] text-sm leading-relaxed max-h-[60%] overflow-y-auto animate-in slide-in-from-bottom-5 duration-200 z-10",onClick:()=>i(!1),children:[e.jsx("div",{className:"mx-auto w-12 h-1 bg-white/20 rounded-full mb-3"}),s.content]}),d.length>1&&e.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-1.5 z-10 pointer-events-none",children:d.map((n,l)=>e.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-all duration-300 shadow-sm ${l===p?"bg-white w-2.5 scale-110":"bg-white/50"}`},l))}),!r&&s.content&&e.jsx("div",{className:"absolute bottom-3 right-3 bg-black/30 text-white p-1.5 rounded-full backdrop-blur-sm pointer-events-none opacity-50 group-hover/image:opacity-100 transition-opacity",children:e.jsx(N,{size:12,className:"rotate-180"})})]}):e.jsx("p",{className:"text-slate-700 font-['Ubuntu'] text-lg leading-relaxed whitespace-pre-wrap",children:s.content})}),e.jsx("div",{className:"bg-slate-100/50 px-4 py-3 flex items-center gap-4 border-t border-slate-100 min-h-[3.5rem]",children:e.jsx("button",{className:"flex items-center gap-2 text-slate-400 hover:text-blue-500 transition-colors group",title:"Bağlantı (Yakında)",children:e.jsx(O,{size:20,className:"group-hover:scale-110 transition-transform"})})})]})};w.propTypes={post:o.shape({id:o.string.isRequired,content:o.string.isRequired,image_url:o.string,images:o.arrayOf(o.string),timestamp:o.shape({seconds:o.number,nanoseconds:o.number,toDate:o.func})}).isRequired,onDelete:o.func};function B(){const[s,c]=m.useState([]),[u,a]=m.useState(null),[r,i]=m.useState(!1),[p,f]=m.useState(!0),h=j.useRef(),x=j.useCallback(t=>{r||(h.current&&h.current.disconnect(),h.current=new IntersectionObserver(n=>{n[0].isIntersecting&&p&&(a(l=>l),g())}),t&&h.current.observe(t))},[r,p]),g=async()=>{if(r||!p)return;i(!0);const t=await T(u);t.posts.length>0?(c(n=>[...n,...t.posts]),a(t.lastVisible),t.posts.length<10&&f(!1)):f(!1),i(!1)},d=t=>{c(n=>n.filter(l=>l.id!==t))};return m.useEffect(()=>{(async()=>{i(!0);const t=await T(null);c(t.posts),a(t.lastVisible),t.posts.length<10&&f(!1),i(!1)})()},[]),e.jsxs("div",{className:"relative flex flex-col w-full h-[100dvh] overflow-hidden bg-slate-50",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[60vw] h-[60vw] bg-slate-300 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob pointer-events-none"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[60vw] h-[60vw] bg-gray-300 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob animation-delay-2000 pointer-events-none"}),e.jsxs("div",{className:"flex-1 overflow-y-auto z-10 w-full max-w-2xl mx-auto px-4 py-6 custom-scrollbar space-y-4",children:[s.map((t,n)=>s.length===n+1?e.jsx("div",{ref:x,children:e.jsx(w,{post:t,onDelete:d})},t.id):e.jsx(w,{post:t,onDelete:d},t.id)),r&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-8 h-8 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin"})}),!p&&s.length>0&&e.jsx("p",{className:"text-center text-slate-400 py-4 text-xs",children:"Tüm gönderiler yüklendi."}),!r&&s.length===0&&e.jsx("div",{className:"flex flex-col items-center justify-center h-full text-slate-400 font-['Ubuntu']",children:e.jsx("p",{children:"Henüz gönderi yok."})})]})]})}export{B as default};

import{r as n,u as v,a as w,b as j,j as e,x as N,y,z as C,A as D}from"./index-C5HVSTo6.js";import{u as _,i as k}from"./post-methods-CchuVWd_.js";import{k as S,l as R,i as z}from"./index-C1ZMg-5I.js";const U=()=>{const[l,c]=n.useState(""),[s,d]=n.useState(null),[r,u]=n.useState(!1),i=n.useRef(null),x=v(),m=w(),a=j().state?.postToEdit;n.useEffect(()=>{x.user||m("/"),a&&c(a.content)},[a]);const f=()=>{i.current.click()},p=t=>{t.target.files&&t.target.files[0]&&d(t.target.files[0])},h=()=>{d(null),i.current&&(i.current.value="")},g=async()=>{if(!l.trim()&&!s||!l.trim())return;u(!0);let t=null;try{if(s){const o=N(y,`posts/${Date.now()}_${s.name}`),b=await C(o,s);t=await D(b.ref)}else a&&a.image_url&&(t=a.image_url);a?await _(a.id,{content:l,image_url:t,updated_at:new Date}):await k({content:l,image_url:t,timestamp:new Date,updated_at:new Date}),c(""),d(null),m("/posts")}catch(o){console.error("Post save error:",o),alert("Gönderi paylaşılırken bir hata oluştu.")}finally{u(!1)}};return e.jsxs("div",{className:"relative flex flex-col w-full h-[100dvh] overflow-hidden bg-slate-50 items-center pt-24",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[60vw] h-[60vw] bg-slate-200 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 pointer-events-none"}),e.jsx("div",{className:"relative z-20 w-full max-w-lg px-4",children:e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-100/50 px-4 py-3 flex items-center gap-3 border-b border-slate-100",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 overflow-hidden",children:e.jsx("img",{src:"https://pbs.twimg.com/profile_images/1483105275766882304/4CYpr2hO_400x400.jpg",alt:"Profile",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-slate-700 font-bold text-sm font-['Ubuntu']",children:"Serhat Öcal"}),e.jsx("span",{className:"text-slate-400 text-xs",children:new Date().toLocaleDateString("tr-TR")})]})]}),e.jsxs("div",{className:"p-4 bg-slate-50/30",children:[e.jsx("textarea",{placeholder:"Ne düşünüyorsun?",className:"w-full h-32 bg-transparent border-none text-slate-700 placeholder-slate-400 outline-none resize-none font-['Ubuntu'] text-lg",value:l,onChange:t=>c(t.target.value),disabled:r}),s&&e.jsxs("div",{className:"mt-2 px-3 py-2 bg-blue-50 rounded-lg flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-blue-600 truncate max-w-[200px] font-medium",children:s.name}),e.jsx("button",{onClick:h,className:"text-blue-400 hover:text-red-500 transition-colors",children:e.jsx(S,{size:16})})]}),e.jsx("input",{type:"file",ref:i,onChange:p,accept:"image/*",className:"hidden"})]}),e.jsxs("div",{className:"bg-slate-100/50 px-4 py-3 flex justify-between items-center border-t border-slate-100",children:[e.jsx("button",{onClick:f,className:`transition-colors p-2 rounded-full hover:bg-slate-200/50 ${s?"text-blue-600 bg-blue-50":"text-slate-400 hover:text-slate-600"}`,title:"Resim Ekle",disabled:r,children:e.jsx(R,{size:24})}),e.jsx("button",{onClick:g,disabled:!l.trim()&&!s||r,className:`transform transition-all duration-200 ${l.trim()||s?"text-blue-600 hover:scale-110":"text-slate-300"}`,children:e.jsx(z,{size:24,className:r?"animate-pulse":""})})]})]})})]})};export{U as default};

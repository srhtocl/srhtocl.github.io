import{j as p,r as d}from"./index-CaIjCW_9.js";import{i as b,r as v,s as M,a as S}from"./notification-D1kFLstK.js";import{z as x}from"./index-COdLnx3c.js";function E(e){return p.jsx("div",{className:"flex flex-col w-full p-4 space-y-4",children:e.messages[0]?e.messages.map((i,r)=>p.jsx("div",{id:r,className:`flex w-full ${i.user==="admin"?"justify-end":"justify-start"}`,children:p.jsx("div",{className:`max-w-[75%] px-5 py-3 rounded-2xl shadow-sm text-sm md:text-base font-['Ubuntu'] ${i.user==="admin"?"bg-slate-700 text-white rounded-tr-none":"bg-white text-slate-800 border border-slate-200 rounded-tl-none"}`,children:i.data})},r)):p.jsx("div",{className:"flex flex-col h-full justify-end pb-4",children:p.jsx("div",{className:"flex w-full justify-end",children:p.jsx("div",{className:"max-w-[75%] px-5 py-3 rounded-2xl shadow-md text-sm md:text-base font-['Ubuntu'] bg-slate-700 text-white rounded-tr-none animate-in fade-in slide-in-from-bottom-4 duration-500",children:"Merhaba."})})})})}function g(e){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var s in r)e[s]=r[s]}return e}var k={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function j(e,i){function r(t,l,n){if(!(typeof document>"u")){n=g({},i,n),typeof n.expires=="number"&&(n.expires=new Date(Date.now()+n.expires*864e5)),n.expires&&(n.expires=n.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var c in n)n[c]&&(a+="; "+c,n[c]!==!0&&(a+="="+n[c].split(";")[0]));return document.cookie=t+"="+e.write(l,t)+a}}function s(t){if(!(typeof document>"u"||arguments.length&&!t)){for(var l=document.cookie?document.cookie.split("; "):[],n={},a=0;a<l.length;a++){var c=l[a].split("="),h=c.slice(1).join("=");try{var m=decodeURIComponent(c[0]);if(n[m]=e.read(h,m),t===m)break}catch{}}return t?n[t]:n}}return Object.create({set:r,get:s,remove:function(t,l){r(t,"",g({},l,{expires:-1}))},withAttributes:function(t){return j(this.converter,g({},this.attributes,t))},withConverter:function(t){return j(g({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(e)}})}var y=j(k,{path:"/"});const T=(e=null)=>{const[i,r]=d.useState([]),[s,t]=d.useState(e),[l,n]=d.useState(!0),[a,c]=d.useState(!1),[h,m]=d.useState(typeof Notification<"u"?Notification.permission:"default"),N=d.useRef(!1);return d.useEffect(()=>{let f=null;return(async()=>{let o=s;if(!e){if(o=y.get("user"),o)y.set("user",o,{expires:7});else{o=new Date().getTime().toString(16),y.set("user",o,{expires:7});const u=await b({user:o,messages:[]});u.success||(x.error("Bağlantı hatası: Kullanıcı oluşturulamadı."),console.error(u.error))}typeof Notification<"u"&&Notification.permission==="granted"&&v(o)}t(o),f=M(o,u=>{u&&u.messages&&r(u.messages),n(!1),N.current=!0})})(),()=>{f&&f()}},[e]),{user:s,messages:i,loading:l,sending:a,sendMessage:async(f,w=!1)=>{if(!f.trim()||a||!s)return;c(!0);const o={user:w?"admin":s,time:new Date().getTime(),data:f.trim()},u=[...i,o];r(u);const C=await S(s,{user:s,messages:u});C.success?!w&&!e&&typeof Notification<"u"&&Notification.permission!=="granted"&&(await v(s),m(Notification.permission)):(x.error("Mesaj gönderilemedi! Lütfen internet bağlantınızı kontrol edin."),console.error("Send Error:",C.error)),c(!1)},notificationPermission:h,enableNotifications:async()=>{if(!s)return;if(typeof Notification>"u"){x.error("Tarayıcınız bildirimleri desteklemiyor.");return}const f=await v(e||s);return m(Notification.permission),f&&x.success("Bildirimler açıldı!"),f}}};export{E as M,T as u};

import{r as u,j as r}from"./index-CcNtxvwf.js";import{M as y}from"./message-field-CBRCC9vA.js";import{s as C,i as S,r as D,a as N,b as U}from"./notification-K7kDXOV0.js";import{h as M}from"./index-1gPmKOmF.js";function g(t){for(var l=1;l<arguments.length;l++){var n=arguments[l];for(var f in n)t[f]=n[f]}return t}var R={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function v(t,l){function n(s,d,e){if(!(typeof document>"u")){e=g({},l,e),typeof e.expires=="number"&&(e.expires=new Date(Date.now()+e.expires*864e5)),e.expires&&(e.expires=e.expires.toUTCString()),s=encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var i in e)e[i]&&(c+="; "+i,e[i]!==!0&&(c+="="+e[i].split(";")[0]));return document.cookie=s+"="+t.write(d,s)+c}}function f(s){if(!(typeof document>"u"||arguments.length&&!s)){for(var d=document.cookie?document.cookie.split("; "):[],e={},c=0;c<d.length;c++){var i=d[c].split("="),p=i.slice(1).join("=");try{var m=decodeURIComponent(i[0]);if(e[m]=t.read(p,m),s===m)break}catch{}}return s?e[s]:e}}return Object.create({set:n,get:f,remove:function(s,d){n(s,"",g({},d,{expires:-1}))},withAttributes:function(s){return v(this.converter,g({},this.attributes,s))},withConverter:function(s){return v(g({},this.converter,s),this.attributes)}},{attributes:{value:Object.freeze(l)},converter:{value:Object.freeze(t)}})}var b=v(R,{path:"/"});function I(){const[t,l]=u.useState(""),[n,f]=u.useState([]),[s,d]=u.useState(null),[e,c]=u.useState(!0),[i,p]=u.useState(!1),m=u.useRef(0),x=u.useRef(!1);u.useEffect(()=>{if(!e){if(!x.current){m.current=n.length,x.current=!0;return}if(n.length>m.current){const a=n[n.length-1];a.user==="admin"&&C("Yeni Cevap Var!",a.data),m.current=n.length}}},[n,e]),u.useEffect(()=>{let a=null;return(async()=>{let o=b.get("user");o?b.set("user",o,{expires:7}):(o=new Date().getTime().toString(16),b.set("user",o,{expires:7}),await S({user:o,messages:[]})),d(o),D(o),a=N(o,h=>{h&&h.messages&&f(h.messages),c(!1)})})(),()=>{a&&a()}},[]);const j=async a=>{if(a.preventDefault(),!t.trim()||i)return;p(!0);const w={user:s,time:new Date().getTime(),data:t.trim()},o=[...n,w];f(o),l("");try{await U(s,{user:s,messages:o})}finally{p(!1)}};return r.jsxs("div",{className:"fixed inset-0 flex flex-col w-full h-full overflow-hidden bg-slate-50 overscroll-none",children:[r.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50vw] h-[50vw] bg-slate-300 rounded-full mix-blend-multiply filter blur-[60px] opacity-20 animate-blob pointer-events-none"}),r.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50vw] h-[50vw] bg-gray-300 rounded-full mix-blend-multiply filter blur-[60px] opacity-20 animate-blob animation-delay-2000 pointer-events-none"}),r.jsx("div",{className:"flex-1 overflow-y-auto z-10 w-full max-w-2xl mx-auto px-4 custom-scrollbar pb-4 pt-4",children:e?r.jsx("div",{className:"flex items-center justify-center h-full",children:r.jsx("div",{className:"w-8 h-8 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin"})}):r.jsx(y,{messages:n})}),r.jsx("div",{className:"flex-none z-20 w-full max-w-2xl mx-auto p-4 bg-slate-50/50 backdrop-blur-md border-t border-white/50",children:r.jsxs("form",{className:"flex items-center gap-2 bg-white rounded-2xl shadow-lg border border-slate-200 p-2 transition-all focus-within:ring-2 focus-within:ring-slate-300/50",onSubmit:j,children:[r.jsx("input",{className:"flex-auto bg-transparent border-none outline-none px-4 py-3 text-slate-700 placeholder-slate-400 font-['Ubuntu'] min-w-0",type:"text",value:t,placeholder:"Bir mesaj bÄ±rak...",onChange:a=>l(a.target.value)}),r.jsx("button",{type:"submit",disabled:!t.trim()||i,className:"flex-none flex items-center justify-center w-12 h-12 bg-slate-900 text-white rounded-xl hover:bg-slate-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md active:scale-95",children:i?r.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):r.jsx(M,{size:20,className:t.trim()?"translate-x-0.5":""})})]})})]})}export{I as default};

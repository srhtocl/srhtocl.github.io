import{u as P,a as S,r as a,j as e,d as b,e as y,g as B,x as C,y as z,z as A,A as E,C as F,D as _,s as I}from"./index-DhgEgQ22.js";import{n as v}from"./index-BBB4lfJl.js";import{b as K,q as j}from"./index-BcBABBbU.js";import{i as N}from"./post-methods-DmU-BLoP.js";const M=()=>{const{user:n}=P(),c=S(),[u,d]=a.useState(""),[s,f]=a.useState(""),[l,R]=a.useState(null),[m,h]=a.useState(!1),[k,x]=a.useState(""),p=a.useRef(null);a.useEffect(()=>{if(!n){c("/");return}(async()=>{try{const i=b(y,"admin","profile"),o=await B(i);if(o.exists()){const r=o.data(),w=r.bio||"";f(w),x(w),d(r.photoURL||"")}else d(n.photoURL||"")}catch(i){console.error("Profil yüklenirken hata:",i)}})()},[n,c]);const U=t=>{t.target.files&&t.target.files[0]&&R(t.target.files[0])},D=()=>{p.current.click()},L=async()=>{h(!0);try{let t=u;if(l){const o=C(z,`profile/admin_profile_${Date.now()}`),r=await A(o,l);t=await E(r.ref)}await F(_.currentUser,{photoURL:t});const i=b(y,"admin","profile");await I(i,{bio:s,photoURL:t,updatedAt:new Date},{merge:!0}),l?await N({content:s,images:[t],image_url:t,timestamp:new Date}):s!==k&&await N({content:`Durum güncellemesi: 

"${s}" ✍️`,images:[],image_url:null,timestamp:new Date}),d(t),x(s),v.success("Profil güncellendi ve paylaşıldı!"),setTimeout(()=>c(0),1e3)}catch(t){console.error("Hata:",t),v.error("Bir hata oluştu: "+t.message)}finally{h(!1)}},g=l?URL.createObjectURL(l):u||null;return e.jsxs("div",{className:"w-full h-full flex flex-col font-['Ubuntu'] bg-slate-50 overflow-y-auto",children:[e.jsx("div",{className:"flex-1 w-full max-w-2xl mx-auto p-6 space-y-8",children:e.jsxs("div",{className:"space-y-8 pt-8 flex flex-col items-center",children:[e.jsxs("div",{className:"relative group cursor-pointer",onClick:D,children:[e.jsxs("div",{className:"w-32 h-32 rounded-full ring-4 ring-white shadow-lg overflow-hidden relative bg-slate-200 flex items-center justify-center",children:[g?e.jsx("img",{src:g,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx(K,{className:"text-slate-400 text-5xl"}),e.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(j,{className:"text-white text-3xl drop-shadow-md"})})]}),e.jsx("div",{className:"absolute bottom-0 right-0 bg-slate-900 text-white p-2 rounded-full shadow-md border-2 border-white hover:bg-blue-600 transition-colors",children:e.jsx(j,{size:16})}),e.jsx("input",{type:"file",ref:p,onChange:U,accept:"image/*",className:"hidden"})]}),e.jsxs("div",{className:"w-full space-y-3",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wider block text-center",children:"Biyografi / Söz"}),e.jsx("div",{className:"relative",children:e.jsx("textarea",{value:s,onChange:t=>f(t.target.value),placeholder:"Bir-iki kelime bile sessizlikten iyidir...",className:"w-full bg-white border border-slate-200 rounded-xl py-4 px-4 text-slate-800 outline-none focus:border-slate-800 focus:ring-1 focus:ring-slate-800 transition-all font-medium placeholder:text-slate-300 shadow-sm min-h-[120px] resize-y font-['Marck_Script'] text-xl text-center"})})]})]})}),e.jsx("div",{className:"p-6 bg-transparent sticky bottom-0 z-10 flex justify-end",children:e.jsx("button",{onClick:L,disabled:m,className:"w-full md:w-auto px-8 py-4 bg-slate-900 text-white rounded-xl font-bold tracking-wide shadow-xl shadow-slate-900/10 active:scale-[0.98] transition-all disabled:opacity-70 disabled:cursor-not-allowed",children:m?"Kaydediliyor...":"KAYDET"})})]})};export{M as default};

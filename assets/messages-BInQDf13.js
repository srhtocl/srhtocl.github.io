import{r,u as m,a as x,j as e,L as h}from"./index-CcNtxvwf.js";import{c as b,s as p,d as j,e as g}from"./notification-K7kDXOV0.js";import{i as v,g as w}from"./index-1gPmKOmF.js";function k(){const[n,u]=r.useState([]),l=m(),c=x(),a=r.useRef(0),d=r.useRef(!0);r.useEffect(()=>{b()},[]),r.useEffect(()=>{if(!n)return;const t=n.reduce((s,i)=>s+(i.messages?i.messages.length:0),0);if(d.current){n.length>0&&(a.current=t,d.current=!1);return}t>a.current&&p("Anonim Mesaj!","Yeni bir mesaj aldınız."),a.current=t},[n]),r.useEffect(()=>{if(!l.user){c("/");return}const t=j(s=>{u(s)});return()=>t()},[l.user,c]);const f=async(t,s)=>{t.preventDefault(),t.stopPropagation(),window.confirm("Bu mesajı silmek istediğinize emin misiniz?")&&(await g(s),u(i=>i.filter(o=>o.docId!==s)))};return e.jsxs("div",{className:"relative flex flex-col w-full h-[100dvh] overflow-hidden bg-slate-50",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[60vw] h-[60vw] bg-slate-200 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob pointer-events-none"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[60vw] h-[60vw] bg-blue-100 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob animation-delay-2000 pointer-events-none"}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-6 z-10 space-y-3 pt-24 pb-24",children:l.user?n.length>0?n.map(t=>{if(!t.messages||!t.messages[0])return null;const s=t.messages.at(-1),i=s.user==="admin";return e.jsxs(h,{to:`/response/${t.user}`,className:"group block bg-white/80 backdrop-blur-md border border-slate-100/50 rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-all active:scale-98",children:[e.jsxs("div",{className:"bg-slate-50/80 px-4 py-2 flex justify-between items-center border-b border-slate-100/50",children:[e.jsx("h3",{className:"text-slate-800 font-bold font-['Ubuntu'] text-sm truncate",children:t.user}),e.jsx("button",{onClick:o=>f(o,t.docId),className:"w-8 h-8 flex items-center justify-center text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-full transition-all shrink-0",title:"Mesajı Sil",children:e.jsx(v,{size:16})})]}),e.jsx("div",{className:"p-4",children:e.jsxs("p",{className:"text-slate-600 text-sm truncate font-['Ubuntu'] leading-relaxed",children:[i&&e.jsx("span",{className:"font-medium text-slate-800",children:"Siz: "}),s.data]})}),s.time&&e.jsx("div",{className:"bg-slate-50/50 px-4 py-2 border-t border-slate-100/50 flex justify-end",children:e.jsx("span",{className:"text-[10px] text-slate-400 font-['Ubuntu']",children:new Date(s.time).toLocaleDateString("tr-TR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})})})]},t.docId||t.user)}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-400 font-['Ubuntu'] gap-4 mt-20",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center",children:e.jsx(w,{size:32})}),e.jsx("p",{children:"Henüz mesaj yok."})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-red-400",children:e.jsx("p",{children:"Yetkisiz Erişim"})})})]})}export{k as default};

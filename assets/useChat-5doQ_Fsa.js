import{j as p,r as d}from"./index-CwJ2VU-d.js";import{i as M,r as v,s as N,a as k}from"./notification-BIlh-c5B.js";import{z as w}from"./index-_62jppvr.js";function E(e){return p.jsx("div",{className:"flex flex-col w-full p-4 space-y-4",children:e.messages[0]?e.messages.map((i,r)=>p.jsx("div",{id:r,className:`flex w-full ${i.user==="admin"?"justify-end":"justify-start"}`,children:p.jsx("div",{className:`max-w-[75%] px-5 py-3 rounded-2xl shadow-sm text-sm md:text-base font-['Ubuntu'] ${i.user==="admin"?"bg-slate-700 text-white rounded-tr-none":"bg-white text-slate-800 border border-slate-200 rounded-tl-none"}`,children:i.data})},r)):p.jsx("div",{className:"flex flex-col items-center justify-center h-full text-slate-500 opacity-70",children:p.jsx("div",{className:"bg-white/50 p-6 rounded-2xl shadow-sm text-center max-w-xs backdrop-blur-sm",children:p.jsx("p",{className:"font-['Ubuntu'] text-sm",children:"Merhaba! Mesajlar anonim olarak iletilir ve tarama geçmişi temizlendiğinde silinir."})})})})}function g(e){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var t in r)e[t]=r[t]}return e}var S={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function C(e,i){function r(n,f,s){if(!(typeof document>"u")){s=g({},i,s),typeof s.expires=="number"&&(s.expires=new Date(Date.now()+s.expires*864e5)),s.expires&&(s.expires=s.expires.toUTCString()),n=encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var c in s)s[c]&&(a+="; "+c,s[c]!==!0&&(a+="="+s[c].split(";")[0]));return document.cookie=n+"="+e.write(f,n)+a}}function t(n){if(!(typeof document>"u"||arguments.length&&!n)){for(var f=document.cookie?document.cookie.split("; "):[],s={},a=0;a<f.length;a++){var c=f[a].split("="),x=c.slice(1).join("=");try{var m=decodeURIComponent(c[0]);if(s[m]=e.read(x,m),n===m)break}catch{}}return n?s[n]:s}}return Object.create({set:r,get:t,remove:function(n,f){r(n,"",g({},f,{expires:-1}))},withAttributes:function(n){return C(this.converter,g({},this.attributes,n))},withConverter:function(n){return C(g({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(e)}})}var j=C(S,{path:"/"});const F=(e=null)=>{const[i,r]=d.useState([]),[t,n]=d.useState(e),[f,s]=d.useState(!0),[a,c]=d.useState(!1),[x,m]=d.useState(Notification.permission),y=d.useRef(!1);return d.useEffect(()=>{let l=null;return(async()=>{let o=t;if(!e){if(o=j.get("user"),o)j.set("user",o,{expires:7});else{o=new Date().getTime().toString(16),j.set("user",o,{expires:7});const u=await M({user:o,messages:[]});u.success||(w.error("Bağlantı hatası: Kullanıcı oluşturulamadı."),console.error(u.error))}Notification.permission==="granted"&&v(o)}n(o),l=N(o,u=>{u&&u.messages&&r(u.messages),s(!1),y.current=!0})})(),()=>{l&&l()}},[e]),{user:t,messages:i,loading:f,sending:a,sendMessage:async(l,h=!1)=>{if(!l.trim()||a||!t)return;c(!0);const o={user:h?"admin":t,time:new Date().getTime(),data:l.trim()},u=[...i,o];r(u);const b=await k(t,{user:t,messages:u});b.success?!h&&!e&&Notification.permission!=="granted"&&(await v(t),m(Notification.permission)):(w.error("Mesaj gönderilemedi! Lütfen internet bağlantınızı kontrol edin."),console.error("Send Error:",b.error)),c(!1)},notificationPermission:x,enableNotifications:async()=>{if(!t)return;const l=await v(e||t);return m(Notification.permission),l&&w.success("Bildirimler açıldı!"),l}}};export{E as M,F as u};

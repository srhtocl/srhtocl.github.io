import{r as n,a as j,j as e,R as b}from"./index-C5HVSTo6.js";import{m as w,n as N,j as y,l as z,o as k}from"./index-C1ZMg-5I.js";import{d as S,g as p}from"./post-methods-CchuVWd_.js";const g=({post:t,onDelete:o})=>{const[x,c]=n.useState(!1),[l,r]=n.useState(!1),d=j(),u=async()=>{window.confirm("Bu gönderiyi silmek istediğinize emin misiniz?")&&(await S(t.id)===null?o&&o(t.id):alert("Silme işlemi başarısız oldu."))};return e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm overflow-hidden relative",children:[e.jsxs("div",{className:"bg-slate-100/50 px-4 py-3 flex justify-between items-center border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 overflow-hidden p-0.5 border border-slate-200",children:e.jsx("img",{src:"https://pbs.twimg.com/profile_images/1483105275766882304/4CYpr2hO_400x400.jpg",alt:"Serhat Öcal",className:"w-full h-full rounded-full object-cover"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-slate-700 font-bold text-sm font-['Ubuntu']",children:"serhat öcal"}),e.jsx("span",{className:"text-slate-400 text-xs",children:(()=>{const a=t.timestamp;return(a?.toDate?a.toDate():new Date(a||Date.now())).toLocaleDateString("tr-TR",{day:"numeric",month:"long",year:"numeric"})})()})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>c(!x),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-200/50 rounded-full transition-colors",children:e.jsx(w,{size:20})}),x&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-36 bg-white rounded-xl shadow-xl border border-slate-100 py-1 z-20 overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("button",{onClick:()=>d("/create-post",{state:{postToEdit:t}}),className:"w-full text-left px-4 py-2.5 text-sm text-slate-600 hover:bg-slate-50 hover:text-blue-600 flex items-center gap-2 transition-colors",children:[e.jsx(N,{size:14}),e.jsx("span",{children:"Düzenle"})]}),e.jsxs("button",{onClick:u,className:"w-full text-left px-4 py-2.5 text-sm text-red-500 hover:bg-red-50 flex items-center gap-2 transition-colors",children:[e.jsx(y,{size:14}),e.jsx("span",{children:"Sil"})]})]}),x&&e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)})]})]}),e.jsx("div",{className:"p-4 bg-slate-50/30 min-h-[5rem]",children:t.image_url&&l?e.jsx("div",{className:"w-full rounded-lg overflow-hidden cursor-pointer",onClick:()=>r(!1),children:e.jsx("img",{src:t.image_url,alt:"Gönderi görseli",className:"w-full h-auto object-cover max-h-[500px]",loading:"lazy"})}):e.jsx("p",{className:"text-slate-700 font-['Ubuntu'] text-lg leading-relaxed whitespace-pre-wrap",children:t.content})}),e.jsxs("div",{className:"bg-slate-100/50 px-4 py-3 flex items-center gap-4 border-t border-slate-100 min-h-[3.5rem]",children:[t.image_url?e.jsx("button",{onClick:()=>r(!l),className:`flex items-center gap-2 transition-colors group ${l?"text-blue-600":"text-slate-400 hover:text-blue-500"}`,title:l?"Metni Göster":"Görseli Göster",children:e.jsx(z,{size:20,className:"group-hover:scale-110 transition-transform"})}):null,e.jsx("button",{className:"flex items-center gap-2 text-slate-400 hover:text-blue-500 transition-colors group",title:"Bağlantı (Yakında)",children:e.jsx(k,{size:20,className:"group-hover:scale-110 transition-transform"})})]})]})};function M(){const[t,o]=n.useState([]),[x,c]=n.useState(null),[l,r]=n.useState(!1),[d,u]=n.useState(!0),a=b.useRef(),f=b.useCallback(s=>{l||(a.current&&a.current.disconnect(),a.current=new IntersectionObserver(i=>{i[0].isIntersecting&&d&&(c(m=>m),v())}),s&&a.current.observe(s))},[l,d]),v=async()=>{if(l||!d)return;r(!0);const s=await p(x);s.posts.length>0?(o(i=>[...i,...s.posts]),c(s.lastVisible),s.posts.length<10&&u(!1)):u(!1),r(!1)},h=s=>{o(i=>i.filter(m=>m.id!==s))};return n.useEffect(()=>{(async()=>{r(!0);const s=await p(null);o(s.posts),c(s.lastVisible),s.posts.length<10&&u(!1),r(!1)})()},[]),e.jsxs("div",{className:"relative flex flex-col w-full h-[100dvh] overflow-hidden bg-slate-50",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[60vw] h-[60vw] bg-slate-300 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob pointer-events-none"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[60vw] h-[60vw] bg-gray-300 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob animation-delay-2000 pointer-events-none"}),e.jsxs("div",{className:"flex-1 overflow-y-auto z-10 w-full max-w-2xl mx-auto px-4 py-6 custom-scrollbar space-y-4",children:[t.map((s,i)=>t.length===i+1?e.jsx("div",{ref:f,children:e.jsx(g,{post:s,onDelete:h})},s.id):e.jsx(g,{post:s,onDelete:h},s.id)),l&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-8 h-8 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin"})}),!d&&t.length>0&&e.jsx("p",{className:"text-center text-slate-400 py-4 text-xs",children:"Tüm gönderiler yüklendi."}),!l&&t.length===0&&e.jsx("div",{className:"flex flex-col items-center justify-center h-full text-slate-400 font-['Ubuntu']",children:e.jsx("p",{children:"Henüz gönderi yok."})})]})]})}export{M as default};

import{B as R,r as m,a as k,j as e,R as w}from"./index-BnrNQZ8p.js";import{m as z,n as _,j as D,l as E,o as C}from"./index-C3ODqJJt.js";import{d as F,g as N}from"./post-methods-kZ99uNqZ.js";var b={exports:{}},v,T;function O(){if(T)return v;T=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return v=r,v}var y,P;function q(){if(P)return y;P=1;var r=O();function o(){}function c(){}return c.resetWarningCache=o,y=function(){function t(u,f,n,h,x,d){if(d!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}t.isRequired=t;function a(){return t}var i={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:a,element:t,elementType:t,instanceOf:a,node:t,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:c,resetWarningCache:o};return i.PropTypes=i,i},y}var S;function I(){return S||(S=1,b.exports=q()()),b.exports}var W=I();const l=R(W),j=({post:r,onDelete:o})=>{const[c,t]=m.useState(!1),[a,i]=m.useState(!1),u=k(),f=async()=>{window.confirm("Bu gönderiyi silmek istediğinize emin misiniz?")&&(await F(r.id)===null?o&&o(r.id):alert("Silme işlemi başarısız oldu."))},n=r.images&&Array.isArray(r.images)?r.images:r.image_url?[r.image_url]:[],h=n.length>0;return e.jsxs("div",{className:"bg-white border border-slate-100 rounded-xl shadow-sm hover:shadow-md transition-shadow duration-300 overflow-hidden group",children:[e.jsxs("div",{className:"px-4 py-3 flex justify-between items-start bg-white/50 border-b border-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 overflow-hidden ring-2 ring-slate-50",children:e.jsx("img",{src:"https://pbs.twimg.com/profile_images/1483105275766882304/4CYpr2hO_400x400.jpg",alt:"Profile",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"text-slate-800 font-bold text-sm font-['Ubuntu']",children:"Serhat Öcal"}),e.jsx("span",{className:"text-slate-400 text-xs font-['Ubuntu']",children:r.timestamp?.seconds?new Date(r.timestamp.seconds*1e3).toLocaleDateString("tr-TR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}):"Tarih yok"})]})]}),user&&user.uid==="2t2Fg2aX8ePpfhsDAWoYEosDcmv1"&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>t(!c),className:"p-2 text-slate-300 hover:text-slate-500 transition-colors",children:e.jsx(z,{size:20})}),c&&e.jsxs("div",{className:"absolute right-0 top-8 bg-white border border-slate-100 shadow-lg rounded-lg py-1 w-32 z-10 animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("button",{onClick:()=>u("/create-post",{state:{postToEdit:r}}),className:"w-full text-left px-4 py-2 text-sm text-slate-600 hover:bg-slate-50 flex items-center gap-2",children:[e.jsx(_,{size:14})," Düzenle"]}),e.jsxs("button",{onClick:f,className:"w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(D,{size:14})," Sil"]})]}),c&&e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>t(!1)})]})]}),e.jsx("div",{className:"p-4 bg-slate-50/30 min-h-[5rem]",children:h&&a?e.jsx("div",{className:"w-full rounded-lg overflow-hidden cursor-pointer flex flex-col gap-2",onClick:()=>i(!1),children:n.map((x,d)=>e.jsx("img",{src:x,alt:`Gönderi görseli ${d+1}`,className:"w-full h-auto object-cover max-h-[500px]",loading:"lazy"},d))}):e.jsx("p",{className:"text-slate-700 font-['Ubuntu'] text-lg leading-relaxed whitespace-pre-wrap",children:r.content})}),e.jsxs("div",{className:"bg-slate-100/50 px-4 py-3 flex items-center gap-4 border-t border-slate-100 min-h-[3.5rem]",children:[h?e.jsxs("button",{onClick:()=>i(!a),className:`flex items-center gap-2 transition-colors group ${a?"text-blue-600":"text-slate-400 hover:text-blue-500"}`,title:a?"Metni Göster":"Görselleri Göster",children:[e.jsx(E,{size:20,className:"group-hover:scale-110 transition-transform"}),n.length>1&&e.jsx("span",{className:"text-xs font-bold bg-slate-200 px-1.5 py-0.5 rounded-full text-slate-600 group-hover:bg-blue-100 group-hover:text-blue-600 transition-colors",children:n.length})]}):null,e.jsx("button",{className:"flex items-center gap-2 text-slate-400 hover:text-blue-500 transition-colors group",title:"Bağlantı (Yakında)",children:e.jsx(C,{size:20,className:"group-hover:scale-110 transition-transform"})})]})]})};j.propTypes={post:l.shape({id:l.string.isRequired,content:l.string.isRequired,image_url:l.string,images:l.arrayOf(l.string),timestamp:l.shape({seconds:l.number,nanoseconds:l.number,toDate:l.func})}).isRequired,onDelete:l.func};function V(){const[r,o]=m.useState([]),[c,t]=m.useState(null),[a,i]=m.useState(!1),[u,f]=m.useState(!0),n=w.useRef(),h=w.useCallback(s=>{a||(n.current&&n.current.disconnect(),n.current=new IntersectionObserver(p=>{p[0].isIntersecting&&u&&(t(g=>g),x())}),s&&n.current.observe(s))},[a,u]),x=async()=>{if(a||!u)return;i(!0);const s=await N(c);s.posts.length>0?(o(p=>[...p,...s.posts]),t(s.lastVisible),s.posts.length<10&&f(!1)):f(!1),i(!1)},d=s=>{o(p=>p.filter(g=>g.id!==s))};return m.useEffect(()=>{(async()=>{i(!0);const s=await N(null);o(s.posts),t(s.lastVisible),s.posts.length<10&&f(!1),i(!1)})()},[]),e.jsxs("div",{className:"relative flex flex-col w-full h-[100dvh] overflow-hidden bg-slate-50",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[60vw] h-[60vw] bg-slate-300 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob pointer-events-none"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[60vw] h-[60vw] bg-gray-300 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob animation-delay-2000 pointer-events-none"}),e.jsxs("div",{className:"flex-1 overflow-y-auto z-10 w-full max-w-2xl mx-auto px-4 py-6 custom-scrollbar space-y-4",children:[r.map((s,p)=>r.length===p+1?e.jsx("div",{ref:h,children:e.jsx(j,{post:s,onDelete:d})},s.id):e.jsx(j,{post:s,onDelete:d},s.id)),a&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-8 h-8 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin"})}),!u&&r.length>0&&e.jsx("p",{className:"text-center text-slate-400 py-4 text-xs",children:"Tüm gönderiler yüklendi."}),!a&&r.length===0&&e.jsx("div",{className:"flex flex-col items-center justify-center h-full text-slate-400 font-['Ubuntu']",children:e.jsx("p",{children:"Henüz gönderi yok."})})]})]})}export{V as default};

import{B as D,r as u,a as F,u as O,j as e,R as S}from"./index-DhgEgQ22.js";import{n as q,o as P,k as W,p as A}from"./index-BcBABBbU.js";import{d as L,g as R}from"./post-methods-DmU-BLoP.js";var w={exports:{}},j,k;function M(){if(k)return j;k=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return j=s,j}var N,z;function U(){if(z)return N;z=1;var s=M();function d(){}function m(){}return m.resetWarningCache=d,N=function(){function r(p,x,f,g,b,h){if(h!==s){var t=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw t.name="Invariant Violation",t}}r.isRequired=r;function a(){return r}var l={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:m,resetWarningCache:d};return l.PropTypes=l,l},N}var E;function V(){return E||(E=1,w.exports=U()()),w.exports}var B=V();const i=D(B),T=({post:s,onDelete:d})=>{const[m,r]=u.useState(!1),[a,l]=u.useState(!1),[p,x]=u.useState(0),[f,g]=u.useState({}),b=F(),{user:h}=O(),t=async()=>{window.confirm("Bu gönderiyi silmek istediğinize emin misiniz?")&&(await L(s.id)===null?d&&d(s.id):alert("Silme işlemi başarısız oldu."))},o=n=>{g(c=>({...c,[n]:!0}))},y=(s.images&&Array.isArray(s.images)?s.images:s.image_url?[s.image_url]:[]).map((n,c)=>({url:n,originalIndex:c})).filter(n=>!f[n.originalIndex]),I=y.length>0;return e.jsxs("div",{className:"bg-white border border-slate-100 rounded-xl shadow-sm hover:shadow-md transition-shadow duration-300 overflow-hidden group",children:[e.jsxs("div",{className:"px-4 py-3 flex justify-between items-start bg-slate-100/50 border-b border-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 overflow-hidden ring-2 ring-slate-50",children:e.jsx("img",{src:"https://pbs.twimg.com/profile_images/1483105275766882304/4CYpr2hO_400x400.jpg",alt:"Profile",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"text-slate-800 font-bold text-sm font-['Ubuntu']",children:"Serhat Öcal"}),e.jsx("span",{className:"text-slate-400 text-xs font-['Ubuntu']",children:s.timestamp?.seconds?new Date(s.timestamp.seconds*1e3).toLocaleDateString("tr-TR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}):"Tarih yok"})]})]}),h&&h.uid==="2t2Fg2aX8ePpfhsDAWoYEosDcmv1"&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>r(!m),className:"p-2 text-slate-300 hover:text-slate-500 transition-colors",children:e.jsx(q,{size:20})}),m&&e.jsxs("div",{className:"absolute right-0 top-8 bg-white border border-slate-100 shadow-lg rounded-lg py-1 w-32 z-20 animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("button",{onClick:()=>b("/create-post",{state:{postToEdit:s}}),className:"w-full text-left px-4 py-2 text-sm text-slate-600 hover:bg-slate-50 flex items-center gap-2",children:[e.jsx(P,{size:14})," Düzenle"]}),e.jsxs("button",{onClick:t,className:"w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(W,{size:14})," Sil"]})]}),m&&e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>r(!1)})]})]}),e.jsx("div",{className:"p-4 bg-slate-50/30 min-h-[5rem]",children:I?e.jsxs("div",{className:"relative w-full rounded-lg overflow-hidden group/image",children:[e.jsx("div",{className:"flex flex-row overflow-x-auto snap-x snap-mandatory scrollbar-hide w-full scroll-smooth",onClick:()=>l(!a),onScroll:n=>{const c=n.currentTarget.offsetWidth,_=n.currentTarget.scrollLeft,C=Math.round(_/c);x(C)},children:y.map((n,c)=>e.jsxs("div",{className:"w-full flex-shrink-0 snap-center relative h-[500px] flex items-center justify-center bg-slate-100 overflow-hidden",children:[e.jsx("img",{src:n.url,alt:"",className:"absolute inset-0 w-full h-full object-cover blur-2xl opacity-50 scale-110",onError:()=>o(n.originalIndex)}),e.jsx("img",{src:n.url,alt:`Gönderi görseli ${c+1}`,className:"relative w-full h-full object-contain z-10 drop-shadow-md transition-transform duration-300",loading:"lazy",onError:()=>o(n.originalIndex)})]},n.originalIndex))}),a&&e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-slate-900/80 backdrop-blur-sm p-4 text-white/90 font-['Ubuntu'] text-sm leading-relaxed max-h-[60%] overflow-y-auto animate-in slide-in-from-bottom-5 duration-200 z-10",onClick:()=>l(!1),children:[e.jsx("div",{className:"mx-auto w-12 h-1 bg-white/20 rounded-full mb-3"}),s.content]}),y.length>1&&e.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-1.5 z-10 pointer-events-none",children:y.map((n,c)=>e.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-all duration-300 shadow-sm ${c===p?"bg-white w-2.5 scale-110":"bg-white/50"}`},c))}),!a&&s.content&&e.jsx("div",{className:"absolute bottom-3 right-3 bg-black/30 text-white p-1.5 rounded-full backdrop-blur-sm pointer-events-none opacity-50 group-hover/image:opacity-100 transition-opacity",children:e.jsx(P,{size:12,className:"rotate-180"})})]}):e.jsx("p",{className:"text-slate-700 font-['Ubuntu'] text-lg leading-relaxed whitespace-pre-wrap",children:s.content})}),e.jsx("div",{className:"bg-slate-100/50 px-4 py-3 flex items-center gap-4 border-t border-slate-100 min-h-[3.5rem]",children:e.jsx("button",{className:"flex items-center gap-2 text-slate-400 hover:text-blue-500 transition-colors group",title:"Bağlantı (Yakında)",children:e.jsx(A,{size:20,className:"group-hover:scale-110 transition-transform"})})})]})};T.propTypes={post:i.shape({id:i.string.isRequired,content:i.string.isRequired,image_url:i.string,images:i.arrayOf(i.string),timestamp:i.shape({seconds:i.number,nanoseconds:i.number,toDate:i.func})}).isRequired,onDelete:i.func};function G(){const[s,d]=u.useState([]),[m,r]=u.useState(null),[a,l]=u.useState(!1),[p,x]=u.useState(!0),f=S.useRef(),g=S.useCallback(t=>{a||(f.current&&f.current.disconnect(),f.current=new IntersectionObserver(o=>{o[0].isIntersecting&&p&&(r(v=>v),b())}),t&&f.current.observe(t))},[a,p]),b=async()=>{if(a||!p)return;l(!0);const t=await R(m);t.posts.length>0?(d(o=>[...o,...t.posts]),r(t.lastVisible),t.posts.length<10&&x(!1)):x(!1),l(!1)},h=t=>{d(o=>o.filter(v=>v.id!==t))};return u.useEffect(()=>{(async()=>{l(!0);const t=await R(null);d(t.posts),r(t.lastVisible),t.posts.length<10&&x(!1),l(!1)})()},[]),e.jsxs("div",{className:"relative flex flex-col w-full h-[100dvh] overflow-hidden bg-slate-50",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[60vw] h-[60vw] bg-slate-300 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob pointer-events-none"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[60vw] h-[60vw] bg-gray-300 rounded-full mix-blend-multiply filter blur-[80px] opacity-20 animate-blob animation-delay-2000 pointer-events-none"}),e.jsxs("div",{className:"flex-1 overflow-y-auto z-10 w-full max-w-2xl mx-auto px-4 py-6 custom-scrollbar space-y-4",children:[s.map((t,o)=>s.length===o+1?e.jsx("div",{ref:g,children:e.jsx(T,{post:t,onDelete:h})},t.id):e.jsx(T,{post:t,onDelete:h},t.id)),a&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-8 h-8 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin"})}),!p&&s.length>0&&e.jsx("p",{className:"text-center text-slate-400 py-4 text-xs",children:"Tüm gönderiler yüklendi."}),!a&&s.length===0&&e.jsx("div",{className:"flex flex-col items-center justify-center h-full text-slate-400 font-['Ubuntu']",children:e.jsx("p",{children:"Henüz gönderi yok."})})]})]})}export{G as default};
